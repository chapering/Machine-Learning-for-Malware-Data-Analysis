package com.adobe.reader.cloud.network;

import android.content.Context;
import android.content.SharedPreferences;
import com.adobe.reader.ARApp;
import com.adobe.reader.ARPrefsEditor;
import java.util.Date;

public class CloudAccount
{
  private static final String ACCESS_TOKEN_KEY = "access_token_KEY";
  private static final String ADOBE_READER_CLOUD_PREFERENCES = "com.adobe.reader.cloud";
  private static final String DOWNLOAD_TOKEN_KEY = "download_token_KEY";
  private static final String EXPIRES_IN_KEY = "expires_in_KEY";
  private static final String REFRESH_TOKEN_KEY = "refresh_token_KEY";
  private static final String ROOT_FOLDER_ID_KEY = "root_folder_id_KEY";
  private static final String TOKEN_START_TIME_KEY = "token_start_time_KEY";
  
  public CloudAccount() {}
  
  public static String getAccessToken()
  {
    return ARApp.getAppContext().getSharedPreferences("com.adobe.reader.cloud", 0).getString("access_token_KEY", null);
  }
  
  public static String getDownloadToken()
  {
    return ARApp.getAppContext().getSharedPreferences("com.adobe.reader.cloud", 0).getString("download_token_KEY", null);
  }
  
  public static long getExpirationDuration()
  {
    SharedPreferences localSharedPreferences = ARApp.getAppContext().getSharedPreferences("com.adobe.reader.cloud", 0);
    long l1 = new Date().getTime() / 1000L;
    long l2 = localSharedPreferences.getLong("token_start_time_KEY", 0L);
    return localSharedPreferences.getLong("expires_in_KEY", 0L) - (l1 - l2);
  }
  
  public static String getRefreshToken()
  {
    return ARApp.getAppContext().getSharedPreferences("com.adobe.reader.cloud", 0).getString("refresh_token_KEY", null);
  }
  
  public static String getRootFolderID()
  {
    return ARApp.getAppContext().getSharedPreferences("com.adobe.reader.cloud", 0).getString("root_folder_id_KEY", null);
  }
  
  public static void initiateAccount(Long paramLong, String paramString1, String paramString2)
  {
    ARPrefsEditor localARPrefsEditor = new ARPrefsEditor(ARApp.getAppContext().getSharedPreferences("com.adobe.reader.cloud", 0));
    localARPrefsEditor.putString("access_token_KEY", paramString2);
    localARPrefsEditor.putString("refresh_token_KEY", paramString1);
    localARPrefsEditor.putLong("expires_in_KEY", paramLong.longValue() / 1000L);
    localARPrefsEditor.putLong("token_start_time_KEY", new Date().getTime() / 1000L);
    localARPrefsEditor.remove("download_token_KEY");
    localARPrefsEditor.apply();
  }
  
  public static boolean isSignedIn()
  {
    return getAccessToken() != null;
  }
  
  public static void removeAccount()
  {
    ARPrefsEditor localARPrefsEditor = new ARPrefsEditor(ARApp.getAppContext().getSharedPreferences("com.adobe.reader.cloud", 0));
    localARPrefsEditor.remove("access_token_KEY");
    localARPrefsEditor.remove("expires_in_KEY");
    localARPrefsEditor.remove("refresh_token_KEY");
    localARPrefsEditor.remove("token_start_time_KEY");
    localARPrefsEditor.remove("download_token_KEY");
    localARPrefsEditor.remove("root_folder_id_KEY");
    localARPrefsEditor.apply();
  }
  
  public static void setDownloadToken(String paramString)
  {
    ARPrefsEditor localARPrefsEditor = new ARPrefsEditor(ARApp.getAppContext().getSharedPreferences("com.adobe.reader.cloud", 0));
    localARPrefsEditor.putString("download_token_KEY", paramString);
    localARPrefsEditor.apply();
  }
  
  public static void setRootFolderID(String paramString)
  {
    ARPrefsEditor localARPrefsEditor = new ARPrefsEditor(ARApp.getAppContext().getSharedPreferences("com.adobe.reader.cloud", 0));
    localARPrefsEditor.putString("root_folder_id_KEY", paramString);
    localARPrefsEditor.apply();
  }
}
