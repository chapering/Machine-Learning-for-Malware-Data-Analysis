package com.adobe.reader;

import android.content.Context;
import android.graphics.PointF;
import android.graphics.Rect;
import android.widget.PopupWindow;

public class ARPopupWindow
  extends PopupWindow
{
  private Context mContext;
  private Rect mLocationRect = null;
  private int mPageNum;
  private PageView mPageView;
  
  public ARPopupWindow(Context paramContext)
  {
    super(paramContext);
    this.mContext = paramContext;
    this.mPageView = ((ARViewer)this.mContext).getPageView();
  }
  
  private boolean isRectOutsideCurrentScreen(PointF paramPointF1, PointF paramPointF2)
  {
    int i = this.mPageView.getScreenHeight();
    if ((paramPointF1.y > i) || (paramPointF2.y < 0.0F)) {}
    do
    {
      return true;
      i = this.mPageView.getScreenWidth();
    } while ((paramPointF1.x > i) || (paramPointF2.x < 0.0F));
    return false;
  }
  
  private void showAtLocation(PointF paramPointF)
  {
    int k = this.mPageView.getScreenHeight();
    int j = this.mPageView.getScreenWidth();
    int n = (int)paramPointF.x;
    int m = (int)paramPointF.y;
    int i;
    if (n < 0)
    {
      i = 0;
      if (m >= 0) {
        break label79;
      }
      j = 0;
    }
    for (;;)
    {
      super.showAtLocation(this.mPageView, 0, i, j);
      super.update(i, j, -1, -1);
      return;
      i = j;
      if (n > j) {
        break;
      }
      i = n;
      break;
      label79:
      j = k;
      if (m <= k) {
        j = m;
      }
    }
  }
  
  public void setLocationRect(Rect paramRect)
  {
    this.mLocationRect = paramRect;
  }
  
  public void showAtDocLocation(PointF paramPointF, int paramInt)
  {
    int i = (int)paramPointF.x;
    int j = (int)paramPointF.y;
    showAtDocLocation(new Rect(i, j, i, j), paramInt);
  }
  
  public void showAtDocLocation(Rect paramRect, int paramInt)
  {
    if (paramRect == null) {
      return;
    }
    setLocationRect(paramRect);
    this.mPageNum = paramInt;
    Object localObject = this.mPageView.getDocViewManager();
    PointF localPointF = ((ARDocViewManager)localObject).convertPointFromDocumentSpaceToDeviceSpace(paramRect.left, paramRect.top, paramInt);
    localObject = ((ARDocViewManager)localObject).convertPointFromDocumentSpaceToDeviceSpace(paramRect.right, paramRect.bottom, paramInt);
    if (isRectOutsideCurrentScreen(localPointF, (PointF)localObject))
    {
      dismiss();
      return;
    }
    if ((paramRect.top != paramRect.bottom) && (paramRect.left != paramRect.right))
    {
      localPointF.x -= 15;
      localPointF.y -= 15;
      ((PointF)localObject).x += 15;
      f1 = ((PointF)localObject).y;
      ((PointF)localObject).y = (15 + f1);
    }
    paramInt = this.mPageView.getScreenHeight();
    int i = this.mPageView.getScreenWidth();
    localPointF.x = Math.max(0.0F, localPointF.x);
    localPointF.y = Math.max(0.0F, localPointF.y);
    ((PointF)localObject).x = Math.min(i, ((PointF)localObject).x);
    ((PointF)localObject).y = Math.min(paramInt, ((PointF)localObject).y);
    int j = getHeight();
    int k = getWidth();
    if (localPointF.y > j)
    {
      f1 = localPointF.x;
      showAtLocation(new PointF((((PointF)localObject).x + f1) / 2.0F - k / 2, localPointF.y - j));
      return;
    }
    if (((PointF)localObject).y + j < paramInt)
    {
      showAtLocation(new PointF((localPointF.x + ((PointF)localObject).x) / 2.0F - k / 2, ((PointF)localObject).y));
      return;
    }
    if (localPointF.x > k)
    {
      f1 = localPointF.x;
      f2 = k;
      f3 = localPointF.y;
      showAtLocation(new PointF(f1 - f2, (((PointF)localObject).y + f3) / 2.0F - j / 2));
      return;
    }
    if (((PointF)localObject).x + k < i)
    {
      f1 = ((PointF)localObject).x;
      f2 = localPointF.y;
      showAtLocation(new PointF(f1, (((PointF)localObject).y + f2) / 2.0F - j / 2));
      return;
    }
    float f1 = (localPointF.x + ((PointF)localObject).x) / 2.0F;
    float f2 = k / 2;
    float f3 = localPointF.y;
    showAtLocation(new PointF(f1 - f2, (((PointF)localObject).y + f3) / 2.0F - j / 2));
  }
  
  public void showAtScrollLocation(PointF paramPointF)
  {
    int i = (int)paramPointF.x;
    int j = (int)paramPointF.y;
    showAtScrollLocation(new Rect(i, j, i, j));
  }
  
  public void showAtScrollLocation(Rect paramRect)
  {
    ARDocViewManager localARDocViewManager = this.mPageView.getDocViewManager();
    int i = localARDocViewManager.getPageAtOffset(paramRect.top);
    PointF localPointF = localARDocViewManager.convertPointFromScrollSpaceToDocumentSpace(paramRect.left, paramRect.top, i);
    paramRect = localARDocViewManager.convertPointFromScrollSpaceToDocumentSpace(paramRect.right, paramRect.bottom, i);
    showAtDocLocation(new Rect((int)localPointF.x, (int)localPointF.y, (int)paramRect.x, (int)paramRect.y), i);
  }
  
  public void showPopupWindow()
  {
    showAtDocLocation(this.mLocationRect, this.mPageNum);
  }
}
