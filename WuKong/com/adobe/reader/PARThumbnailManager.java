package com.adobe.reader;

import android.graphics.Rect;
import android.widget.ImageView;

public class PARThumbnailManager
{
  private static final float kBufferMemorySize = 500.0F;
  private static final int kMaxThumbnailHeight = 162;
  private static final int kMaxThumbnailWidth = 152;
  private static final int kThumbnailThreshold = 10;
  private ARViewer mAdobeReader = null;
  private long mCoreThumbnailManager = 0L;
  private double mMaxMemoryUsage = 0.0D;
  private double mMaxThumbnailSize = 0.0D;
  
  public PARThumbnailManager(ARViewer paramARViewer, long paramLong)
  {
    this.mAdobeReader = paramARViewer;
    this.mCoreThumbnailManager = getCoreThumbnailManager(paramLong);
  }
  
  private void checkCoreThumbnailManager()
  {
    if (0L == this.mCoreThumbnailManager) {
      throw new IllegalStateException();
    }
  }
  
  private Rect computeThumbnailSize(int paramInt1, int paramInt2)
  {
    Rect localRect = new Rect();
    localRect.right = Math.max(Math.max(paramInt1, paramInt2) / 3, 152);
    localRect.bottom = Math.max(localRect.width(), 162);
    this.mMaxThumbnailSize = PARTile.calculateTileSize(localRect.width(), localRect.height());
    this.mMaxMemoryUsage = (this.mMaxThumbnailSize * 10.0D + 500.0D);
    return localRect;
  }
  
  private native boolean drawThumbnail(long paramLong, int paramInt, ImageView paramImageView);
  
  private native long getCoreThumbnailManager(long paramLong);
  
  private native int getNumThumbnailsInMemory(long paramLong);
  
  private native void setThumbnailSize(long paramLong, int paramInt1, int paramInt2);
  
  protected boolean drawThumbnail(int paramInt, ImageView paramImageView)
  {
    checkCoreThumbnailManager();
    return drawThumbnail(this.mCoreThumbnailManager, paramInt, paramImageView);
  }
  
  public double getCurrentMemoryUsage()
  {
    checkCoreThumbnailManager();
    return this.mMaxThumbnailSize * getNumThumbnailsInMemory(this.mCoreThumbnailManager);
  }
  
  public double getMaxMemoryUsage()
  {
    return this.mMaxMemoryUsage;
  }
  
  public void setThumbnailSizeFromScreenSize(int paramInt1, int paramInt2)
  {
    checkCoreThumbnailManager();
    Rect localRect = computeThumbnailSize(paramInt1, paramInt2);
    setThumbnailSize(this.mCoreThumbnailManager, localRect.width(), localRect.height());
  }
  
  protected void thumbnailReadyForPage(int paramInt, PARTile paramPARTile)
  {
    paramPARTile = (PARPageThumbnailView)this.mAdobeReader.findViewById(2131493119);
    if (((paramPARTile == null) || (!paramPARTile.areThumbnailsVisible())) && (this.mAdobeReader.getScrubberPageNum() == paramInt)) {
      drawThumbnail(paramInt, (ImageView)this.mAdobeReader.findViewById(2131492908));
    }
  }
}
