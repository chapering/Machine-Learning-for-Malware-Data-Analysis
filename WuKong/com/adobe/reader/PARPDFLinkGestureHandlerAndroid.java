package com.adobe.reader;

import android.app.AlertDialog;
import android.content.ActivityNotFoundException;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.content.Intent;
import android.net.Uri;
import java.util.Timer;
import java.util.TimerTask;

public class PARPDFLinkGestureHandlerAndroid
{
  private static final String HTTPS_K = "https";
  private static final String HTTP_K = "http";
  private static final String MAILTO_K = "mailto";
  private static final long sDelayPeriod = 300L;
  private ARViewer mContext;
  private PARPDFLinkViewAndroid mLinkView = null;
  private PageView mPageView = null;
  private Timer timer = null;
  
  PARPDFLinkGestureHandlerAndroid(ARViewer paramARViewer)
  {
    this.mContext = paramARViewer;
    this.mPageView = this.mContext.getPageView();
  }
  
  void clearRect()
  {
    if (this.timer != null)
    {
      this.timer.cancel();
      this.timer = null;
    }
    if (this.mPageView.indexOfChild(this.mLinkView) != -1) {
      this.mPageView.removeView(this.mLinkView);
    }
    this.mLinkView = null;
  }
  
  void highlightRect(int paramInt1, int paramInt2, int paramInt3, int paramInt4)
  {
    this.mContext.showPreviousPosButton();
    this.mLinkView = new PARPDFLinkViewAndroid(this.mContext);
    this.mPageView.addViewAtLocation(this.mLinkView, paramInt2 - paramInt1, paramInt4 - paramInt3, paramInt1, paramInt3);
    final HighlightRectRunnable localHighlightRectRunnable = new HighlightRectRunnable(this.mLinkView, this.mPageView);
    this.timer = new Timer();
    this.timer.schedule(new TimerTask()
    {
      public void run()
      {
        PARPDFLinkGestureHandlerAndroid.this.mContext.runOnUiThread(localHighlightRectRunnable);
      }
    }, 300L);
  }
  
  void openIntent(Uri paramUri)
  {
    try
    {
      paramUri = new Intent("android.intent.action.VIEW").setData(paramUri);
      this.mContext.startActivity(paramUri);
      return;
    }
    catch (ActivityNotFoundException paramUri) {}
  }
  
  void openURL(String paramString)
  {
    if ((paramString == null) || (paramString.length() == 0)) {
      return;
    }
    if (paramString.toLowerCase().startsWith("https")) {
      localObject = paramString.replaceFirst(paramString.substring(0, "https".length()), "https");
    }
    final Uri localUri;
    for (;;)
    {
      localUri = Uri.parse((String)localObject);
      if (!((String)localObject).toLowerCase().startsWith("mailto")) {
        break;
      }
      openIntent(localUri);
      return;
      localObject = paramString;
      if (paramString.toLowerCase().startsWith("http")) {
        localObject = paramString.replaceFirst(paramString.substring(0, "http".length()), "http");
      }
    }
    paramString = localUri.getHost();
    Object localObject = localUri.getScheme() + "://" + paramString;
    int i = localUri.getPort();
    paramString = (String)localObject;
    if (i != -1) {
      paramString = localObject + ":" + i;
    }
    localObject = new AlertDlg(this.mContext);
    ((AlertDialog)localObject).setTitle(this.mContext.getString(2131362044));
    ((AlertDialog)localObject).setMessage(this.mContext.getString(2131362045, new Object[] { paramString }));
    ((AlertDialog)localObject).setButton(-1, this.mContext.getString(2131361827), new DialogInterface.OnClickListener()
    {
      public void onClick(DialogInterface paramAnonymousDialogInterface, int paramAnonymousInt)
      {
        PARPDFLinkGestureHandlerAndroid.this.openIntent(localUri);
      }
    });
    ((AlertDialog)localObject).setButton(-2, this.mContext.getString(2131361910), new DialogInterface.OnClickListener()
    {
      public void onClick(DialogInterface paramAnonymousDialogInterface, int paramAnonymousInt) {}
    });
    ((AlertDialog)localObject).show();
  }
  
  class HighlightRectRunnable
    implements Runnable
  {
    private PARPDFLinkViewAndroid mLinkView;
    private PageView mPageView;
    
    public HighlightRectRunnable(PARPDFLinkViewAndroid paramPARPDFLinkViewAndroid, PageView paramPageView)
    {
      this.mLinkView = paramPARPDFLinkViewAndroid;
      this.mPageView = paramPageView;
    }
    
    public void run()
    {
      this.mPageView.removeView(this.mLinkView);
    }
  }
}
